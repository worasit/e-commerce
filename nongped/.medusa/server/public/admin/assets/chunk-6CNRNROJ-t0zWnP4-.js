import{r as c,cs as D,ct as x,cu as g,k as q}from"./index-CJZ0utKv.js";var E=()=>{const[a,n]=c.useState(""),[s,t]=c.useState(""),r=c.useCallback(D(i=>t(i),300),[]);return c.useEffect(()=>(r(a),()=>r.cancel()),[a,r]),{searchValue:a,onSearchValueChange:n,query:s||void 0}},C=({queryKey:a,queryFn:n,getOptions:s,defaultValue:t,defaultValueKey:r,pageSize:i=10})=>{const{searchValue:u,onSearchValueChange:b,query:f}=E(),p=r||"id",{data:h}=x({queryKey:a,queryFn:async()=>n({[p]:t,limit:Array.isArray(t)?t.length:1}),enabled:!!t}),{data:d,...l}=g({queryKey:[...a,f],queryFn:async({pageParam:e=0})=>await n({q:f,limit:i,offset:e}),initialPageParam:0,getNextPageParam:e=>e.count>e.offset+e.limit?e.offset+e.limit:void 0,placeholderData:q}),o=(d==null?void 0:d.pages.flatMap(e=>s(e)))??[],m=h?s(h):[],v=!l.isPending&&!o.length&&!u;return t&&m.length&&!u&&m.forEach(e=>{o.find(y=>y.value===e.value)||o.unshift(e)}),{options:o,searchValue:u,onSearchValueChange:b,disabled:v,...l}};export{E as a,C as u};
