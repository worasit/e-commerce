import{B as J}from"./chunk-YL5TLRXX-DDyS67qF.js";import{f as Re}from"./chunk-IR5DHEKS-aVJcUHa1.js";import{u as He,a as _e,b as Ue}from"./chunk-YAQNI7BB-CYyCSzWC.js";import{u as We,a as Ne,b as Ve}from"./chunk-HVKSIETZ-DMs27n1G.js";import{g as Qe}from"./chunk-PXZ7QYKX-DZ_CHK12.js";import{u as Ye,a as Ke}from"./chunk-FCB7ZHPR-BqImc-AP.js";import{O as Ge,g as Xe,a as Je}from"./chunk-MS6NEJ3L-D0K848aH.js";import{r as Ze}from"./chunk-K7S5TX6I-MuDmvKsR.js";import{f as ue}from"./chunk-OV5NMSY6-CzJZ0JaW.js";import{D as ie}from"./chunk-AMJSV3NG-DPKI1Y1t.js";import{g as Pe}from"./chunk-XFSJ7YIN-CYgS8ok5.js";import{u as es,a as ne,b as ss}from"./chunk-P75BH6ZT-BCyrBbuC.js";import{a as q,g as S}from"./chunk-FSMQADBD-DQ6u7KYm.js";import{r as v,aK as Ce,j as e,q as ts,aL as as,aD as xe,b as y,V as D,B as N,aM as is,d as ns,R as ls,a as cs,aN as le,S as rs,aO as ds,s as os,u as $,aP as ze,H as w,T as d,ah as Oe,aQ as ms,L as ce,aR as us,A as R,av as xs,a0 as ps,aS as fs,aT as hs,aU as gs,aF as js,aV as ys,aW as vs,aX as bs,aY as te,m as W,t as O,aZ as B,a_ as _s,a$ as Ns,b0 as Cs,b1 as zs,b2 as Os,b3 as ks,b4 as Ss,b5 as A,Y as K,b6 as ke}from"./index-CJZ0utKv.js";import{i as qs,a as L}from"./chunk-OIAPXGI2-D0wb1bhE.js";import{a as ws,T as Z}from"./chunk-2RQLKDBF-DdHfvUFV.js";import{u as G}from"./chunk-HG5TSG3K-BtN5fyyg.js";import{f as re}from"./format-B_KHsbPT.js";import{A as de}from"./arrow-path-BMvYkQJb.js";import{X as Se}from"./x-circle-DvpCPk2O.js";import{P as Es}from"./pencil-square-CANgz5Uf.js";import{A as X}from"./arrow-down-right-mini-BNPElVet.js";import{D as qe}from"./document-text-DhZQsG8W.js";import{u as I}from"./use-prompt-Bi7FceQH.js";import{C as E}from"./container-CvrRqui1.js";import{C as T}from"./copy-DcCqtuUL.js";import{S as F}from"./status-badge-K2cHY97K.js";import{P as M}from"./popover-Dq5pafWl.js";import"./chunk-GDZSURH3-DTIOnH9F.js";import"./Trans-CyKh6hGN.js";import"./chunk-MWVM4TYO-bKUcYSnf.js";import"./x-mark-mini-ysYOSGAt.js";import"./prompt-Di3JszOJ.js";import"./index-poKGl5ZU.js";var Ms=Object.defineProperty,V=Object.getOwnPropertySymbols,we=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable,pe=(s,t,i)=>t in s?Ms(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,As=(s,t)=>{for(var i in t||(t={}))we.call(t,i)&&pe(s,i,t[i]);if(V)for(var i of V(t))Ee.call(t,i)&&pe(s,i,t[i]);return s},Ts=(s,t)=>{var i={};for(var a in s)we.call(s,a)&&t.indexOf(a)<0&&(i[a]=s[a]);if(s!=null&&V)for(var a of V(s))t.indexOf(a)<0&&Ee.call(s,a)&&(i[a]=s[a]);return i};const Me=v.forwardRef((s,t)=>{var i=s,{color:a="currentColor"}=i,n=Ts(i,["color"]);return v.createElement("svg",As({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:t},n),v.createElement("path",{stroke:a,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13.056 7.5H1.944M9.278 3.722 13.056 7.5l-3.778 3.778"}))});Me.displayName="ArrowLongRight";var Is=Object.defineProperty,Q=Object.getOwnPropertySymbols,Ae=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable,fe=(s,t,i)=>t in s?Is(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,Ls=(s,t)=>{for(var i in t||(t={}))Ae.call(t,i)&&fe(s,i,t[i]);if(Q)for(var i of Q(t))Te.call(t,i)&&fe(s,i,t[i]);return s},Ds=(s,t)=>{var i={};for(var a in s)Ae.call(s,a)&&t.indexOf(a)<0&&(i[a]=s[a]);if(s!=null&&Q)for(var a of Q(s))t.indexOf(a)<0&&Te.call(s,a)&&(i[a]=s[a]);return i};const Ie=v.forwardRef((s,t)=>{var i=s,{color:a="currentColor"}=i,n=Ds(i,["color"]);return v.createElement("svg",Ls({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:t},n),v.createElement("g",{stroke:a,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},v.createElement("path",{d:"M1.056 4.611 7.07 7.93a.89.89 0 0 0 .858 0l6.015-3.318"}),v.createElement("path",{d:"M2.833 12.611h9.334c.982 0 1.777-.796 1.777-1.778V4.167c0-.982-.796-1.778-1.777-1.778H2.833c-.981 0-1.777.796-1.777 1.778v6.666c0 .982.796 1.778 1.777 1.778"})),v.createElement("defs",null,v.createElement("clipPath",{id:"a"},v.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});Ie.displayName="Envelope";var $s=Object.defineProperty,Y=Object.getOwnPropertySymbols,Le=Object.prototype.hasOwnProperty,De=Object.prototype.propertyIsEnumerable,he=(s,t,i)=>t in s?$s(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,Bs=(s,t)=>{for(var i in t||(t={}))Le.call(t,i)&&he(s,i,t[i]);if(Y)for(var i of Y(t))De.call(t,i)&&he(s,i,t[i]);return s},Fs=(s,t)=>{var i={};for(var a in s)Le.call(s,a)&&t.indexOf(a)<0&&(i[a]=s[a]);if(s!=null&&Y)for(var a of Y(s))t.indexOf(a)<0&&De.call(s,a)&&(i[a]=s[a]);return i};const $e=v.forwardRef((s,t)=>{var i=s,{color:a="currentColor"}=i,n=Fs(i,["color"]);return v.createElement("svg",Bs({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:t},n),v.createElement("path",{stroke:a,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7.5 1.5v5.333M11.278 4.167H3.722c-.982 0-1.778.796-1.778 1.778v5.333c0 .982.796 1.778 1.778 1.778h7.556c.982 0 1.778-.796 1.778-1.778V5.945c0-.982-.796-1.778-1.778-1.778"}),v.createElement("path",{stroke:a,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"m2.167 5.086 1.288-2.598c.3-.605.917-.988 1.593-.988h4.904c.676 0 1.293.383 1.593.988l1.288 2.599M4.167 10.833h1.777"}))});$e.displayName="FlyingBox";var ga=s=>{const{id:t}=s.params||{},{order:i}=Ce(t,{fields:ie},{initialData:s.data,enabled:!!t});return i?e.jsxs("span",{children:["#",i.display_id]}):null},Rs=s=>({queryKey:ds.detail(s),queryFn:async()=>os.admin.order.retrieve(s,{fields:ie})}),ja=async({params:s})=>{const t=s.id,i=Rs(t);return ts.ensureQueryData(i)},Hs=({orderPreview:s})=>{var o;const{t}=y(),i=(o=s==null?void 0:s.order_change)==null?void 0:o.claim_id,{mutateAsync:a}=He(i,s.id),n=$(),c=async()=>{n(`/orders/${s.id}/claims`)},r=async()=>{await a(void 0,{onSuccess:()=>{O.success(t("orders.claims.toast.canceledSuccessfully"))},onError:u=>{O.error(u.message)}})};if(i)return e.jsx("div",{style:{background:"repeating-linear-gradient(-45deg, rgb(212, 212, 216, 0.15), rgb(212, 212, 216,.15) 10px, transparent 10px, transparent 20px)"},className:"-m-4 mb-1 border-b border-l p-4",children:e.jsx(E,{className:"flex items-center justify-between p-0",children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2 px-6 pt-4",children:[e.jsx(ze,{className:"text-ui-fg-subtle"}),e.jsx(w,{level:"h2",children:t("orders.claims.panel.title")})]}),e.jsx("div",{className:"gap-2 px-6 pb-4",children:e.jsx(d,{children:t("orders.claims.panel.description")})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-x-2 rounded-b-xl px-4 py-4",children:[e.jsx(N,{size:"small",variant:"secondary",onClick:r,children:t("orders.claims.cancel.title")}),e.jsx(N,{size:"small",variant:"secondary",onClick:c,children:t("actions.continue")})]})]})})})},Us=({orderPreview:s})=>{var o;const{t}=y(),i=(o=s==null?void 0:s.order_change)==null?void 0:o.exchange_id,{mutateAsync:a}=We(i,s.id),n=$(),c=async()=>{n(`/orders/${s.id}/exchanges`)},r=async()=>{await a(void 0,{onSuccess:()=>{O.success(t("orders.exchanges.toast.canceledSuccessfully"))},onError:u=>{O.error(u.message)}})};if(i)return e.jsx("div",{style:{background:"repeating-linear-gradient(-45deg, rgb(212, 212, 216, 0.15), rgb(212, 212, 216,.15) 10px, transparent 10px, transparent 20px)"},className:"-m-4 mb-1 border-b border-l p-4",children:e.jsx(E,{className:"flex items-center justify-between p-0",children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2 px-6 pt-4",children:[e.jsx(de,{className:"text-ui-fg-subtle"}),e.jsx(w,{level:"h2",children:t("orders.exchanges.panel.title")})]}),e.jsx("div",{className:"gap-2 px-6 pb-4",children:e.jsx(d,{children:t("orders.exchanges.panel.description")})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-x-2 rounded-b-xl px-4 py-4",children:[e.jsx(N,{size:"small",variant:"secondary",onClick:r,children:t("orders.exchanges.cancel.title")}),e.jsx(N,{size:"small",variant:"secondary",onClick:c,children:t("actions.continue")})]})]})})})},Ws=({orderPreview:s})=>{const{t}=y(),i=s==null?void 0:s.order_change,a=i==null?void 0:i.return_id,n=(i==null?void 0:i.change_type)==="return_request"&&!!i.return_id,{mutateAsync:c}=es(a,s.id),r=$(),o=async()=>{r(`/orders/${s.id}/returns`)},u=async()=>{await c(void 0,{onSuccess:()=>{O.success(t("orders.returns.toast.canceledSuccessfully"))},onError:x=>{O.error(x.message)}})};if(!(!a||!n))return e.jsx("div",{style:{background:"repeating-linear-gradient(-45deg, rgb(212, 212, 216, 0.15), rgb(212, 212, 216,.15) 10px, transparent 10px, transparent 20px)"},className:"-m-4 mb-1 border-b border-l p-4",children:e.jsx(E,{className:"flex items-center justify-between p-0",children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2 px-6 pt-4",children:[e.jsx(Oe,{className:"text-ui-fg-subtle"}),e.jsx(w,{level:"h2",children:t("orders.returns.panel.title")})]}),e.jsx("div",{className:"gap-2 px-6 pb-4",children:e.jsx(d,{children:t("orders.returns.panel.description")})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-x-2 rounded-b-xl px-4 py-4",children:[e.jsx(N,{size:"small",variant:"secondary",onClick:u,children:t("orders.returns.cancel.title")}),e.jsx(N,{size:"small",variant:"secondary",onClick:o,children:t("actions.continue")})]})]})})})};function ge({item:s,quantity:t}){return e.jsx("div",{className:"text-ui-fg-subtle items-center gap-x-2",children:e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsxs("div",{className:"w-fit min-w-[27px]",children:[e.jsx("span",{className:"txt-small tabular-nums",children:t}),"x"]}),e.jsx(B,{src:s.thumbnail}),e.jsx("span",{className:"txt-small text-ui-fg-subtle font-medium",children:s.title}),s.variant_sku&&" · ",s.variant_sku&&e.jsxs("div",{className:"flex items-center gap-x-1",children:[e.jsx("span",{className:"txt-small",children:s.variant_sku}),e.jsx(T,{content:s.variant_sku,className:"text-ui-fg-muted"})]})]})},s.id)}var Vs=({order:s})=>{var g,f;const{t}=y(),i=$(),{order:a}=le(s.id),{mutateAsync:n}=Ye(s.id),{mutateAsync:c}=Ke(s.id),r=((g=a.order_change)==null?void 0:g.status)==="pending",[o,u]=v.useMemo(()=>{const m=[],b=[],j=new Map(s.items.map(_=>[_.id,_]));return((a==null?void 0:a.items)||[]).forEach(_=>{const z=j.get(_.id);if(!z){m.push({item:_,quantity:_.quantity});return}z.quantity>_.quantity&&b.push({item:_,quantity:z.quantity-_.quantity}),z.quantity<_.quantity&&m.push({item:_,quantity:_.quantity-z.quantity})}),[m,b]},[a]),x=async()=>{try{await c(),O.success(t("orders.edits.toast.confirmedSuccessfully"))}catch(m){O.error(m.message)}},p=async()=>{try{await n(),O.success(t("orders.edits.toast.canceledSuccessfully"))}catch(m){O.error(m.message)}};return!a||((f=a.order_change)==null?void 0:f.change_type)!=="edit"?null:e.jsx("div",{style:{background:"repeating-linear-gradient(-45deg, rgb(212, 212, 216, 0.15), rgb(212, 212, 216,.15) 10px, transparent 10px, transparent 20px)"},className:"-m-4 mb-1 border-b border-l p-4",children:e.jsx(E,{className:"flex items-center justify-between p-0",children:e.jsxs("div",{className:"flex w-full flex-col divide-y divide-dashed",children:[e.jsxs("div",{className:"flex items-center gap-2 px-6 py-4",children:[e.jsx(ms,{className:"text-blue-500"}),e.jsx(w,{level:"h2",children:t(r?"orders.edits.panel.titlePending":"orders.edits.panel.title")})]}),!!o.length&&e.jsxs("div",{className:"txt-small text-ui-fg-subtle flex flex-row px-6 py-4",children:[e.jsx("span",{className:"flex-1 font-medium",children:t("labels.added")}),e.jsx("div",{className:"flex flex-1 flex-col gap-y-2",children:o.map(({item:m,quantity:b})=>e.jsx(ge,{item:m,quantity:b},m.id))})]}),!!u.length&&e.jsxs("div",{className:"txt-small text-ui-fg-subtle flex flex-row px-6 py-4",children:[e.jsx("span",{className:"flex-1 font-medium",children:t("labels.removed")}),e.jsx("div",{className:"flex flex-1 flex-col gap-y-2",children:u.map(({item:m,quantity:b})=>e.jsx(ge,{item:m,quantity:b},m.id))})]}),e.jsxs("div",{className:"bg-ui-bg-subtle flex items-center justify-end gap-x-2 rounded-b-xl px-4 py-4",children:[r?e.jsx(N,{size:"small",variant:"secondary",onClick:()=>i(`/orders/${s.id}/edits`),children:t("actions.continueEdit")}):e.jsx(N,{size:"small",variant:"secondary",onClick:x,children:t("actions.forceConfirm")}),e.jsx(N,{size:"small",variant:"secondary",onClick:p,children:t("actions.cancel")})]})]})})})};function Qs(s){const{t}=y(),[i,a]=v.useState(!1),n=s.itemsToSend,c=s.itemsToReturn,r=s.itemsMap,o=s.title,u=()=>{a(!0)},x=()=>{a(!1)};if(!(!(n!=null&&n.length)&&!(c!=null&&c.length)))return e.jsxs(M,{open:i,children:[e.jsx(M.Trigger,{onMouseEnter:u,onMouseLeave:x,autoFocus:!1,className:"focus-visible:outline-none",children:e.jsx(d,{size:"small",leading:"compact",weight:"plus",children:o})}),e.jsx(M.Content,{align:"center",side:"top",className:"bg-ui-bg-component max-w-[200px] p-0 focus-visible:outline-none",children:e.jsxs("div",{className:"flex flex-col",children:[!!(n!=null&&n.length)&&e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"txt-compact-small-plus mb-1",children:t("orders.activity.events.common.toSend")}),e.jsxs("div",{className:"flex flex-col",children:[n==null?void 0:n.map(p=>{const g=r==null?void 0:r.get(p.item_id);return e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsxs(d,{size:"small",className:"text-ui-fg-subtle",children:[p.quantity,"x"]}),e.jsx(B,{src:g==null?void 0:g.thumbnail}),e.jsx(d,{className:"txt-compact-small text-ui-fg-subtle truncate",children:`${g==null?void 0:g.variant_title} · ${g==null?void 0:g.product_title}`})]},p.id)}),e.jsx("div",{className:"flex flex-1 flex-row items-center gap-2"})]})]}),!!(c!=null&&c.length)&&e.jsxs("div",{className:"border-t-2 border-dotted p-3",children:[e.jsx("div",{className:"txt-compact-small-plus mb-1",children:t("orders.activity.events.common.toReturn")}),e.jsxs("div",{className:"flex flex-col",children:[c==null?void 0:c.map(p=>{const g=r==null?void 0:r.get(p.item_id);return e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsxs(d,{size:"small",className:"text-ui-fg-subtle",children:[p.quantity,"x"]}),e.jsx(B,{src:g==null?void 0:g.thumbnail}),e.jsx(d,{className:"txt-compact-small text-ui-fg-subtle truncate",children:`${g==null?void 0:g.variant_title} · ${g==null?void 0:g.product_title}`})]},p.id)}),e.jsx("div",{className:"flex flex-1 flex-row items-center gap-2"})]})]})]})})]})}var Ys=Qs;function Ks(s){const{t}=y(),[i,a]=v.useState(!1),n=s.previous,c=s.next,r=s.title,o=()=>{a(!0)},u=()=>{a(!1)};return!n&&!c?null:e.jsxs(M,{open:i,children:[e.jsx(M.Trigger,{onMouseEnter:o,onMouseLeave:u,autoFocus:!1,className:"focus-visible:outline-none",children:e.jsx(d,{size:"small",leading:"compact",weight:"plus",children:r})}),e.jsx(M.Content,{align:"center",side:"top",className:"bg-ui-bg-component max-w-[200px] p-0 focus-visible:outline-none",children:e.jsxs("div",{className:"flex flex-col",children:[!!n&&e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"txt-compact-small-plus mb-1",children:t("labels.from")}),e.jsx("p",{className:"txt-compact-small text-ui-fg-subtle",children:n})]}),!!c&&e.jsxs("div",{className:"border-t-2 border-dotted p-3",children:[e.jsx("div",{className:"txt-compact-small-plus mb-1",children:t("labels.to")}),e.jsx("p",{className:"txt-compact-small text-ui-fg-subtle",children:c})]})]})})]})}var P=Ks,Gs=["transfer","update_order"],Xs=({order:s})=>{const t=Js(s);if(t.length<=3)return e.jsx("div",{className:"flex flex-col gap-y-0.5",children:t.map((c,r)=>e.jsx(U,{title:c.title,timestamp:c.timestamp,isFirst:r===t.length-1,itemsToSend:c.itemsToSend,itemsToReturn:c.itemsToReturn,itemsMap:c.itemsMap,children:c.children},r))});const i=t.slice(0,2),a=t.slice(2,t.length-1),n=t[t.length-1];return e.jsxs("div",{className:"flex flex-col gap-y-0.5",children:[i.map((c,r)=>e.jsx(U,{title:c.title,timestamp:c.timestamp,itemsToSend:c.itemsToSend,itemsToReturn:c.itemsToReturn,itemsMap:c.itemsMap,children:c.children},r)),e.jsx(Zs,{activities:a}),e.jsx(U,{title:n.title,timestamp:n.timestamp,isFirst:!0,itemsToSend:n.itemsToSend,itemsToReturn:n.itemsToReturn,itemsMap:n.itemsMap,children:n.children})]})},Js=s=>{const{t}=y(),{order_changes:i=[]}=_s(s.id,{change_type:["edit","claim","exchange","return","transfer","update_order"]}),a=i.filter(m=>!Gs.includes(m.change_type)),n=it(s,a),{order_items:c=[]}=Ns(s.id,{fields:"+quantity",item_id:n},{enabled:!!a.length}),r=v.useMemo(()=>{var b;const m=new Map((b=s==null?void 0:s.items)==null?void 0:b.map(j=>[j.id,j]));for(const j of n){const _=c.find(z=>z.item.id===j);_&&m.set(j,{..._.item,quantity:_.quantity})}return m},[s.items,c,n]),{returns:o=[]}=ne({order_id:s.id,fields:"+received_at,*items"}),{claims:u=[]}=_e({order_id:s.id,fields:"*additional_items"}),{exchanges:x=[]}=Ne({order_id:s.id,fields:"*additional_items"}),p=Je(s),g=[];return v.useMemo(()=>{var z,k;const m=[];for(const l of p){const h=l.amount;m.push({title:t("orders.activity.events.payment.awaiting"),timestamp:l.created_at,children:e.jsx(d,{size:"small",className:"text-ui-fg-subtle",children:q(h,l.currency_code)})}),l.canceled_at&&m.push({title:t("orders.activity.events.payment.canceled"),timestamp:l.canceled_at,children:e.jsx(d,{size:"small",className:"text-ui-fg-subtle",children:q(h,l.currency_code)})}),l.captured_at&&m.push({title:t("orders.activity.events.payment.captured"),timestamp:l.captured_at,children:e.jsx(d,{size:"small",className:"text-ui-fg-subtle",children:q(h,l.currency_code)})});for(const C of l.refunds||[])m.push({title:t("orders.activity.events.payment.refunded"),timestamp:C.created_at,children:e.jsx(d,{size:"small",className:"text-ui-fg-subtle",children:q(C.amount,l.currency_code)})})}for(const l of s.fulfillments||[])m.push({title:t("orders.activity.events.fulfillment.created"),timestamp:l.created_at,children:e.jsx(ee,{fulfillment:l})}),l.delivered_at&&m.push({title:t("orders.activity.events.fulfillment.delivered"),timestamp:l.delivered_at,children:e.jsx(ee,{fulfillment:l})}),l.shipped_at&&m.push({title:t("orders.activity.events.fulfillment.shipped"),timestamp:l.shipped_at,children:e.jsx(ee,{fulfillment:l,isShipment:!0})}),l.canceled_at&&m.push({title:t("orders.activity.events.fulfillment.canceled"),timestamp:l.canceled_at});const b=new Map;for(const l of o)b.set(l.id,l),!(l.claim_id||l.exchange_id)&&(m.push({title:t("orders.activity.events.return.created",{returnId:l.id.slice(-7)}),timestamp:l.created_at,itemsToReturn:l==null?void 0:l.items,itemsMap:r,children:e.jsx(je,{orderReturn:l,isCreated:!l.canceled_at})}),l.canceled_at&&m.push({title:t("orders.activity.events.return.canceled",{returnId:l.id.slice(-7)}),timestamp:l.canceled_at}),(l.status==="received"||l.status==="partially_received")&&m.push({title:t("orders.activity.events.return.received",{returnId:l.id.slice(-7)}),timestamp:l.received_at,itemsToReturn:l==null?void 0:l.items,itemsMap:r,children:e.jsx(je,{orderReturn:l,isReceived:!0})}));for(const l of u){const h=b.get(l.return_id);m.push({title:t(l.canceled_at?"orders.activity.events.claim.canceled":"orders.activity.events.claim.created",{claimId:l.id.slice(-7)}),timestamp:l.canceled_at||l.created_at,itemsToSend:l.additional_items,itemsToReturn:h==null?void 0:h.items,itemsMap:r,children:e.jsx(Ps,{claim:l,claimReturn:h})})}for(const l of x){const h=b.get(l.return_id);m.push({title:t(l.canceled_at?"orders.activity.events.exchange.canceled":"orders.activity.events.exchange.created",{exchangeId:l.id.slice(-7)}),timestamp:l.canceled_at||l.created_at,itemsToSend:l.additional_items,itemsToReturn:h==null?void 0:h.items,itemsMap:r,children:e.jsx(et,{exchange:l,exchangeReturn:h})})}for(const l of i.filter(h=>h.change_type==="edit")){const h=l.status==="confirmed";l.status!=="pending"&&m.push({title:t(`orders.activity.events.edit.${l.status}`,{editId:l.id.slice(-7)}),timestamp:l.status==="requested"?l.requested_at:l.status==="confirmed"?l.confirmed_at:l.status==="declined"?l.declined_at:l.status==="canceled"?l.canceled_at:l.created_at,children:h?e.jsx(st,{edit:l}):null})}for(const l of i.filter(h=>h.change_type==="transfer"))l.requested_at&&m.push({title:t("orders.activity.events.transfer.requested",{transferId:l.id.slice(-7)}),timestamp:l.requested_at,children:e.jsx(tt,{transfer:l})}),l.confirmed_at&&m.push({title:t("orders.activity.events.transfer.confirmed",{transferId:l.id.slice(-7)}),timestamp:l.confirmed_at}),l.declined_at&&m.push({title:t("orders.activity.events.transfer.declined",{transferId:l.id.slice(-7)}),timestamp:l.declined_at});for(const l of i.filter(h=>h.change_type==="update_order")){const h=(k=(z=l.actions[0])==null?void 0:z.details)==null?void 0:k.type;h==="shipping_address"&&m.push({title:e.jsx(P,{title:t("orders.activity.events.update_order.shipping_address"),previous:L({address:l.actions[0].details.old}).join(", "),next:L({address:l.actions[0].details.new}).join(", ")}),timestamp:l.created_at,children:e.jsxs("div",{className:"mt-2 flex text-sm gap-x-2 text-ui-fg-subtle",children:[t("fields.by")," ",e.jsx(J,{id:l.created_by})]})}),h==="billing_address"&&m.push({title:e.jsx(P,{title:t("orders.activity.events.update_order.billing_address"),previous:L({address:l.actions[0].details.old}).join(", "),next:L({address:l.actions[0].details.new}).join(", ")}),timestamp:l.created_at,children:e.jsxs("div",{className:"mt-2 flex text-sm gap-x-2 text-ui-fg-subtle",children:[t("fields.by")," ",e.jsx(J,{id:l.created_by})]})}),h==="email"&&m.push({title:e.jsx(P,{title:t("orders.activity.events.update_order.email"),previous:l.actions[0].details.old,next:l.actions[0].details.new}),timestamp:l.created_at,children:e.jsxs("div",{className:"mt-2 flex text-sm gap-x-2 text-ui-fg-subtle",children:[t("fields.by")," ",e.jsx(J,{id:l.created_by})]})})}s.canceled_at&&m.push({title:t("orders.activity.events.canceled.title"),timestamp:s.canceled_at});const j=m.sort((l,h)=>new Date(h.timestamp).getTime()-new Date(l.timestamp).getTime()),_={title:t("orders.activity.events.placed.title"),timestamp:s.created_at,children:e.jsx(d,{size:"small",className:"text-ui-fg-subtle",children:q(s.total,s.currency_code)})};return[...j,_]},[s,p,o,x,i,g,!1,r])},U=({title:s,timestamp:t,isFirst:i=!1,children:a,itemsToSend:n,itemsToReturn:c,itemsMap:r})=>{const{getFullDate:o,getRelativeDate:u}=G();return e.jsxs("div",{className:"grid grid-cols-[20px_1fr] items-start gap-2",children:[e.jsxs("div",{className:"flex size-full flex-col items-center gap-y-0.5",children:[e.jsx("div",{className:"flex size-5 items-center justify-center",children:e.jsx("div",{className:"bg-ui-bg-base shadow-borders-base flex size-2.5 items-center justify-center rounded-full",children:e.jsx("div",{className:"bg-ui-tag-neutral-icon size-1.5 rounded-full"})})}),!i&&e.jsx("div",{className:"bg-ui-border-base w-px flex-1"})]}),e.jsxs("div",{className:W({"pb-4":!i}),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[n!=null&&n.length||c!=null&&c.length?e.jsx(Ys,{title:s,itemsToSend:n,itemsToReturn:c,itemsMap:r},s):e.jsx(d,{size:"small",leading:"compact",weight:"plus",children:s}),t&&e.jsx(D,{content:o({date:t,includeTime:!0}),children:e.jsx(d,{size:"small",leading:"compact",className:"text-ui-fg-subtle text-right",children:u(t)})})]}),e.jsx("div",{children:a})]})]})},Zs=({activities:s})=>{const[t,i]=v.useState(!1),{t:a}=y();return s.length?e.jsxs(Cs,{open:t,onOpenChange:i,children:[!t&&e.jsxs("div",{className:"grid grid-cols-[20px_1fr] items-start gap-2",children:[e.jsx("div",{className:"flex size-full flex-col items-center",children:e.jsx("div",{className:"border-ui-border-strong w-px flex-1 bg-[linear-gradient(var(--border-strong)_33%,rgba(255,255,255,0)_0%)] bg-[length:1px_3px] bg-right bg-repeat-y"})}),e.jsx("div",{className:"pb-4",children:e.jsx(zs,{className:"text-left",children:e.jsx(d,{size:"small",leading:"compact",weight:"plus",className:"text-ui-fg-muted",children:a("orders.activity.showMoreActivities",{count:s.length})})})})]}),e.jsx(Os,{children:e.jsx("div",{className:"flex flex-col gap-y-0.5",children:s.map((n,c)=>e.jsx(U,{title:n.title,timestamp:n.timestamp,itemsToSend:n.itemsToSend,itemsToReturn:n.itemsToReturn,itemsMap:n.itemsMap,children:n.children},c))})})]}):null},ee=({fulfillment:s})=>{const{t}=y(),i=s.items.reduce((a,n)=>a+n.quantity,0);return e.jsx("div",{children:e.jsx(d,{size:"small",className:"text-ui-fg-subtle",children:t("orders.activity.events.fulfillment.items",{count:i})})})},je=({orderReturn:s,isCreated:t,isReceived:i})=>{const a=I(),{t:n}=y(),{mutateAsync:c}=ss(s.id,s.order_id),r=async()=>{await a({title:n("orders.returns.cancel.title"),description:n("orders.returns.cancel.description"),confirmText:n("actions.confirm"),cancelText:n("actions.cancel")})&&await c()},o=s.items.reduce((u,x)=>u+(i?x.received_quantity:x.quantity),0);return e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx(d,{size:"small",className:"text-ui-fg-subtle",children:n("orders.activity.events.return.items",{count:o})}),t&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-[2px] flex items-center leading-none",children:"⋅"}),e.jsx(N,{onClick:r,className:"text-ui-fg-subtle h-auto px-0 leading-none hover:bg-transparent",variant:"transparent",size:"small",children:n("actions.cancel")})]})]})},Ps=({claim:s,claimReturn:t})=>{const i=I(),{t:a}=y(),n=!!s.created_at,{mutateAsync:c}=Ue(s.id,s.order_id),r=async()=>{await i({title:a("orders.claims.cancel.title"),description:a("orders.claims.cancel.description"),confirmText:a("actions.confirm"),cancelText:a("actions.cancel")})&&await c()},o=(s.additional_items||[]).reduce((x,p)=>x+p.quantity,0),u=((t==null?void 0:t.items)||[]).reduce((x,p)=>x+p.quantity,0);return e.jsxs("div",{children:[o>0&&e.jsx(d,{size:"small",className:"text-ui-fg-subtle",children:a("orders.activity.events.claim.itemsInbound",{count:o})}),u>0&&e.jsx(d,{size:"small",className:"text-ui-fg-subtle",children:a("orders.activity.events.claim.itemsOutbound",{count:u})}),!n&&e.jsx(N,{onClick:r,className:"text-ui-fg-subtle h-auto px-0 leading-none hover:bg-transparent",variant:"transparent",size:"small",children:a("actions.cancel")})]})},et=({exchange:s,exchangeReturn:t})=>{const i=I(),{t:a}=y(),n=!!s.canceled_at,{mutateAsync:c}=Ve(s.id,s.order_id),r=async()=>{await i({title:a("orders.exchanges.cancel.title"),description:a("orders.exchanges.cancel.description"),confirmText:a("actions.confirm"),cancelText:a("actions.cancel")})&&await c()},o=(s.additional_items||[]).reduce((x,p)=>x+p.quantity,0),u=((t==null?void 0:t.items)||[]).reduce((x,p)=>x+p.quantity,0);return e.jsxs("div",{children:[o>0&&e.jsx(d,{size:"small",className:"text-ui-fg-subtle",children:a("orders.activity.events.exchange.itemsInbound",{count:o})}),u>0&&e.jsx(d,{size:"small",className:"text-ui-fg-subtle",children:a("orders.activity.events.exchange.itemsOutbound",{count:u})}),!n&&e.jsx(N,{onClick:r,className:"text-ui-fg-subtle h-auto px-0 leading-none hover:bg-transparent",variant:"transparent",size:"small",children:a("actions.cancel")})]})},st=({edit:s})=>{const{t}=y(),[i,a]=v.useMemo(()=>at(s.actions),[s]);return e.jsxs("div",{children:[i>0&&e.jsxs(d,{size:"small",className:"text-ui-fg-subtle",children:[t("labels.added"),": ",i]}),a>0&&e.jsxs(d,{size:"small",className:"text-ui-fg-subtle",children:[t("labels.removed"),": ",a]})]})},tt=({transfer:s})=>{var u;const t=I(),{t:i}=y(),a=s.actions[0],{customer:n}=ks(a.reference_id),c=!!s.confirmed_at,{mutateAsync:r}=Ss(s.order_id),o=async()=>{await t({title:i("general.areYouSure"),description:i("actions.cannotUndo"),confirmText:i("actions.delete"),cancelText:i("actions.cancel")})&&await r()};return e.jsxs("div",{children:[e.jsxs(d,{size:"small",className:"text-ui-fg-subtle",children:[i("orders.activity.from"),": ",(u=a.details)==null?void 0:u.original_email]}),e.jsxs(d,{size:"small",className:"text-ui-fg-subtle",children:[i("orders.activity.to"),":"," ",n!=null&&n.first_name?`${n==null?void 0:n.first_name} ${n==null?void 0:n.last_name}`:n==null?void 0:n.email]}),!c&&e.jsx(N,{onClick:o,className:"text-ui-fg-subtle h-auto px-0 leading-none hover:bg-transparent",variant:"transparent",size:"small",children:i("actions.cancel")})]})};function at(s){let t=0,i=0;return s.forEach(a=>{if(a.action==="ITEM_ADD"&&(t+=a.details.quantity),a.action==="ITEM_UPDATE"){const n=a.details.quantity_diff;n>0?t+=n:i+=Math.abs(n)}}),[t,i]}function it(s,t){if(!(t!=null&&t.length))return[];const i=new Set,a=new Map(s.items.map(n=>[n.id,!0]));return t.forEach(n=>{n.actions.forEach(c=>{c.details.reference_id.startsWith("ordli_")&&!a.has(c.details.reference_id)&&i.add(c.details.reference_id)})}),Array.from(i)}var nt=({order:s})=>{const{t}=y();return e.jsxs(E,{className:"flex flex-col gap-y-8 px-6 py-4",children:[e.jsx("div",{className:"flex flex-col gap-y-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(w,{level:"h2",children:t("orders.activity.header")})})}),e.jsx(Xs,{order:s})]})},lt=({data:s})=>{const{t}=y(),i=s.customer_id,a=ot(s),n=s.email,c=(a||n||"").charAt(0).toUpperCase();return e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(d,{size:"small",leading:"compact",weight:"plus",children:t("fields.id")}),e.jsx(ce,{to:`/customers/${i}`,className:"focus:shadow-borders-focus rounded-[4px] outline-none transition-shadow",children:e.jsxs("div",{className:"flex items-center gap-x-2 overflow-hidden",children:[e.jsx(us,{size:"2xsmall",fallback:c}),e.jsx(d,{size:"small",leading:"compact",className:"text-ui-fg-subtle hover:text-ui-fg-base transition-fg truncate",children:a||n})]})})]})},ct=({data:s})=>{var a,n;const{t}=y(),i=((a=s.shipping_address)==null?void 0:a.company)||((n=s.billing_address)==null?void 0:n.company);return i?e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(d,{size:"small",leading:"compact",weight:"plus",children:t("fields.company")}),e.jsx(d,{size:"small",leading:"compact",className:"truncate",children:i})]}):null},rt=({data:s})=>{var n,c;const{t}=y(),i=((n=s.shipping_address)==null?void 0:n.phone)||((c=s.billing_address)==null?void 0:c.phone),a=s.email||"";return e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(d,{size:"small",leading:"compact",weight:"plus",children:t("orders.customer.contactLabel")}),e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsxs("div",{className:"grid grid-cols-[1fr_20px] items-start gap-x-2",children:[e.jsx(d,{size:"small",leading:"compact",className:"text-pretty break-all",children:a}),e.jsx("div",{className:"flex justify-end",children:e.jsx(T,{content:a,className:"text-ui-fg-muted"})})]}),i&&e.jsxs("div",{className:"grid grid-cols-[1fr_20px] items-start gap-x-2",children:[e.jsx(d,{size:"small",leading:"compact",className:"text-pretty break-all",children:i}),e.jsx("div",{className:"flex justify-end",children:e.jsx(T,{content:a,className:"text-ui-fg-muted"})})]})]})]})},ye=({address:s,type:t})=>{const{t:i}=y();return e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(d,{size:"small",leading:"compact",weight:"plus",children:i(t==="shipping"?"addresses.shippingAddress.label":"addresses.billingAddress.label")}),s?e.jsxs("div",{className:"grid grid-cols-[1fr_20px] items-start gap-x-2",children:[e.jsx(d,{size:"small",leading:"compact",children:L({address:s}).map((a,n)=>e.jsxs("span",{className:"break-words",children:[a,e.jsx("br",{})]},n))}),e.jsx("div",{className:"flex justify-end",children:e.jsx(T,{content:L({address:s}).join(`
`),className:"text-ui-fg-muted"})})]}):e.jsx(d,{size:"small",leading:"compact",children:"-"})]})},dt=({data:s})=>{const{t}=y();return e.jsxs("div",{className:"divide-y",children:[e.jsx(ye,{address:s.shipping_address,type:"shipping"}),qs(s.shipping_address,s.billing_address)?e.jsxs("div",{className:"grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(d,{size:"small",leading:"compact",weight:"plus",className:"text-ui-fg-subtle",children:t("addresses.billingAddress.label")}),e.jsx(d,{size:"small",leading:"compact",className:"text-ui-fg-muted",children:t("addresses.billingAddress.sameAsShipping")})]}):e.jsx(ye,{address:s.billing_address,type:"billing"})]})},H=Object.assign({},{ID:lt,Company:ct,Contact:rt,Addresses:dt}),ot=s=>{const{first_name:t,last_name:i}=s.shipping_address||{},{first_name:a,last_name:n}=s.billing_address||{},{first_name:c,last_name:r}=s.customer||{},o=[c,r].filter(Boolean).join(" "),u=[t,i].filter(Boolean).join(" "),x=[a,n].filter(Boolean).join(" ");return o||u||x},mt=({order:s})=>e.jsxs(E,{className:"divide-y p-0",children:[e.jsx(ut,{}),e.jsx(H.ID,{data:s}),e.jsx(H.Contact,{data:s}),e.jsx(H.Company,{data:s}),e.jsx(H.Addresses,{data:s})]}),ut=()=>{const{t:s}=y();return e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(w,{level:"h2",children:s("fields.customer")}),e.jsx(R,{groups:[{actions:[{label:s("transferOwnership.label"),to:"transfer",icon:e.jsx(de,{})}]},{actions:[{label:s("addresses.shippingAddress.editLabel"),to:"shipping-address",icon:e.jsx($e,{})},{label:s("addresses.billingAddress.editLabel"),to:"billing-address",icon:e.jsx(xs,{})}]},{actions:[{label:s("email.editLabel"),to:"email",icon:e.jsx(Ie,{})}]}]})]})},xt=({order:s})=>{const t=s.fulfillments||[];return e.jsxs("div",{className:"flex flex-col gap-y-3",children:[e.jsx(ft,{order:s}),t.map((i,a)=>e.jsx(ht,{index:a,fulfillment:i,order:s},i.id))]})},pt=({item:s,currencyCode:t})=>{var i;return e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsxs("div",{className:"flex items-start gap-x-4",children:[e.jsx(B,{src:s.thumbnail}),e.jsxs("div",{children:[e.jsx(d,{size:"small",leading:"compact",weight:"plus",className:"text-ui-fg-base",children:s.title}),s.variant_sku&&e.jsxs("div",{className:"flex items-center gap-x-1",children:[e.jsx(d,{size:"small",children:s.variant_sku}),e.jsx(T,{content:s.variant_sku,className:"text-ui-fg-muted"})]}),e.jsx(d,{size:"small",children:(i=s.variant)==null?void 0:i.options.map(a=>a.value).join(" · ")})]})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-x-4",children:[e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(d,{size:"small",children:S(s.unit_price,t)})}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsxs(d,{children:[e.jsx("span",{className:"tabular-nums",children:s.quantity-s.detail.fulfilled_quantity}),"x"]})}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(d,{size:"small",children:S(s.subtotal||0,t)})})]})]},s.id)},ft=({order:s})=>{const t=s.items.filter(a=>a.requires_shipping&&a.detail.fulfilled_quantity<a.quantity),i=s.items.filter(a=>!a.requires_shipping&&a.detail.fulfilled_quantity<a.quantity);return e.jsxs(e.Fragment,{children:[!!t.length&&e.jsx(ve,{order:s,unfulfilledItems:t,requiresShipping:!0}),!!i.length&&e.jsx(ve,{order:s,unfulfilledItems:i,requiresShipping:!1})]})},ve=({order:s,unfulfilledItems:t,requiresShipping:i=!1})=>{const{t:a}=y();return e.jsxs(E,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(w,{level:"h2",children:a("orders.fulfillment.unfulfilledItems")}),e.jsxs("div",{className:"flex items-center gap-x-4",children:[i&&e.jsx(F,{color:"red",className:"text-nowrap",children:a("orders.fulfillment.requiresShipping")}),e.jsx(F,{color:"red",className:"text-nowrap",children:a("orders.fulfillment.awaitingFulfillmentBadge")}),e.jsx(R,{groups:[{actions:[{label:a("orders.fulfillment.fulfillItems"),icon:e.jsx(ps,{}),to:`/orders/${s.id}/fulfillment?requires_shipping=${i}`}]}]})]})]}),e.jsx("div",{children:t.map(n=>e.jsx(pt,{item:n,currencyCode:s.currency_code},n.id))})]})},ht=({fulfillment:s,order:t,index:i})=>{const{t:a}=y(),n=I(),c=$(),r=!!s.location_id,{stock_location:o,isError:u,error:x}=fs(s.location_id,void 0,{enabled:r});let p=s.requires_shipping?"Awaiting shipping":"Awaiting delivery",g="blue",f=s.created_at;s.canceled_at?(p="Canceled",g="red",f=s.canceled_at):s.delivered_at?(p="Delivered",g="green",f=s.delivered_at):s.shipped_at&&(p="Shipped",g="green",f=s.shipped_at);const{mutateAsync:m}=hs(t.id,s.id),{mutateAsync:b}=gs(t.id,s.id),j=!s.canceled_at&&!s.shipped_at&&!s.delivered_at&&s.requires_shipping,_=!s.canceled_at&&!s.delivered_at,z=async()=>{await n({title:a("general.areYouSure"),description:a("orders.fulfillment.markAsDeliveredWarning"),confirmText:a("actions.continue"),cancelText:a("actions.cancel"),variant:"confirmation"})&&await b({},{onSuccess:()=>{O.success(a("orders.fulfillment.toast.fulfillmentDelivered"))},onError:h=>{O.error(h.message)}})},k=async()=>{if(s.shipped_at){O.warning(a("orders.fulfillment.toast.fulfillmentShipped"));return}await n({title:a("general.areYouSure"),description:a("orders.fulfillment.cancelWarning"),confirmText:a("actions.continue"),cancelText:a("actions.cancel")})&&await m(void 0,{onSuccess:()=>{O.success(a("orders.fulfillment.toast.canceled"))},onError:h=>{O.error(h.message)}})};if(u)throw x;return e.jsxs(E,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(w,{level:"h2",children:a("orders.fulfillment.number",{number:i+1})}),e.jsxs("div",{className:"flex items-center gap-x-4",children:[e.jsx(D,{content:re(new Date(f),"dd MMM, yyyy, HH:mm:ss"),children:e.jsx(F,{color:g,className:"text-nowrap",children:p})}),e.jsx(R,{groups:[{actions:[{label:a("actions.cancel"),icon:e.jsx(Se,{}),onClick:k,disabled:!!s.canceled_at}]}]})]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(d,{size:"small",leading:"compact",weight:"plus",children:a("orders.fulfillment.itemsLabel")}),e.jsx("ul",{children:s.items.map(l=>e.jsx("li",{children:e.jsxs(d,{size:"small",leading:"compact",children:[l.quantity,"x ",l.title]})},l.line_item_id))})]}),r&&e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(d,{size:"small",leading:"compact",weight:"plus",children:a("orders.fulfillment.shippingFromLabel")}),o?e.jsx(ce,{to:`/settings/locations/${o.id}`,className:"text-ui-fg-interactive hover:text-ui-fg-interactive-hover transition-fg",children:e.jsx(d,{size:"small",leading:"compact",children:o.name})}):e.jsx(js,{className:"w-16"})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(d,{size:"small",leading:"compact",weight:"plus",children:a("fields.provider")}),e.jsx(d,{size:"small",leading:"compact",children:Re(s.provider_id)})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(d,{size:"small",leading:"compact",weight:"plus",children:a("orders.fulfillment.trackingLabel")}),e.jsx("div",{children:s.labels&&s.labels.length>0?e.jsx("ul",{children:s.labels.map(l=>l.url&&l.url.length>0&&l.url!=="#"?e.jsx("li",{children:e.jsx("a",{href:l.url,target:"_blank",rel:"noopener noreferrer",className:"text-ui-fg-interactive hover:text-ui-fg-interactive-hover transition-fg",children:e.jsx(d,{size:"small",leading:"compact",children:l.tracking_number})})},l.tracking_number):e.jsx("li",{children:e.jsx(d,{size:"small",leading:"compact",children:l.tracking_number})},l.tracking_number))}):e.jsx(d,{size:"small",leading:"compact",children:"-"})})]}),(j||_)&&e.jsxs("div",{className:"bg-ui-bg-subtle flex items-center justify-end gap-x-2 rounded-b-xl px-4 py-4",children:[_&&e.jsx(N,{onClick:z,variant:"secondary",children:a("orders.fulfillment.markAsDelivered")}),j&&e.jsx(N,{onClick:()=>c(`./${s.id}/create-shipment`),variant:"secondary",children:a("orders.fulfillment.markAsShipped")})]})]})},gt=({order:s})=>{var c;const{t}=y(),i=I(),{mutateAsync:a}=ys(s.id),n=async()=>{await i({title:t("general.areYouSure"),description:t("orders.cancelWarning",{id:`#${s.display_id}`}),confirmText:t("actions.continue"),cancelText:t("actions.cancel")})&&await a()};return e.jsxs(E,{className:"flex items-center justify-between px-6 py-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-x-1",children:[e.jsxs(w,{children:["#",s.display_id]}),e.jsx(T,{content:`#${s.display_id}`,className:"text-ui-fg-muted"})]}),e.jsx(d,{size:"small",className:"text-ui-fg-subtle",children:t("orders.onDateFromSalesChannel",{date:re(new Date(s.created_at),"dd MMM, yyyy, HH:mm:ss"),salesChannel:(c=s.sales_channel)==null?void 0:c.name})})]}),e.jsxs("div",{className:"flex items-center gap-x-4",children:[e.jsxs("div",{className:"flex items-center gap-x-1.5",children:[e.jsx(yt,{order:s}),e.jsx(jt,{order:s})]}),e.jsx(R,{groups:[{actions:[{label:t("actions.cancel"),onClick:n,icon:e.jsx(Se,{})}]}]})]})]})},jt=({order:s})=>{const{t}=y(),{label:i,color:a}=Pe(t,s.fulfillment_status);return e.jsx(F,{color:a,className:"text-nowrap",children:i})},yt=({order:s})=>(y(),null),vt=({groups:s,children:t})=>e.jsxs(A,{children:[e.jsx(A.Trigger,{asChild:!0,children:t}),e.jsx(A.Content,{children:s.map((i,a)=>{if(!i.actions.length)return null;const n=a===s.length-1;return e.jsxs(A.Group,{children:[i.actions.map((c,r)=>c.onClick?e.jsxs(A.Item,{disabled:c.disabled,onClick:o=>{o.stopPropagation(),c.onClick()},className:W("[&_svg]:text-ui-fg-subtle flex items-center gap-x-2",{"[&_svg]:text-ui-fg-disabled":c.disabled}),children:[c.icon,e.jsx("span",{children:c.label})]},r):e.jsx("div",{children:e.jsx(A.Item,{className:W("[&_svg]:text-ui-fg-subtle flex items-center gap-x-2",{"[&_svg]:text-ui-fg-disabled":c.disabled}),asChild:!0,disabled:c.disabled,children:e.jsxs(ce,{to:c.to,onClick:o=>o.stopPropagation(),children:[c.icon,e.jsx("span",{children:c.label})]})})},r)),!n&&e.jsx(A.Separator,{})]},a)})})]}),bt=as(Ze()),_t="",Be=xe.forwardRef(({paymentCollection:s,order:t},i)=>{const[a,n]=v.useState(!1),[c,r]=v.useState(!1),[o,u]=v.useState("CopyPaymentLink"),{t:x}=y(),p=async g=>{g.stopPropagation(),n(!0),(0,bt.default)(`${_t}/payment-collection/${s.id}`),setTimeout(()=>{n(!1)},2e3)};return xe.useEffect(()=>{if(a){u(x("actions.copied"));return}setTimeout(()=>{u(x("actions.copy"))},500)},[a]),e.jsx(D,{content:o,open:a||c,onOpenChange:r,children:e.jsxs(N,{ref:i,variant:"secondary",size:"small","aria-label":"CopyPaymentLink code snippet",onClick:p,children:[a?e.jsx(is,{className:"inline"}):e.jsx(ws,{className:"inline"}),x("orders.payment.paymentLink",{amount:q(s.amount,t==null?void 0:t.currency_code)})]})})});Be.displayName="CopyPaymentLink";function be(s){const t=new Date(s);t.setMinutes(t.getMinutes()-t.getTimezoneOffset());const a=Intl.DateTimeFormat().resolvedOptions().hour12?"dd MMM yyyy hh:MM a":"dd MMM yyyy HH:MM";return re(t,a)}function Nt({orderReturn:s}){const{t}=y(),[i,a]=v.useState(!1),n=()=>{a(!0)},c=()=>{a(!1)};let r="Return",o=s.id;if(s.claim_id&&(r="Claim",o=s.claim_id),s.exchange_id&&(r="Exchange",o=s.exchange_id),typeof s=="object")return e.jsxs(M,{open:i,children:[e.jsx(M.Trigger,{onMouseEnter:n,onMouseLeave:c,autoFocus:!1,className:"focus-visible:outline-none align-sub",children:e.jsx(ke,{})}),e.jsx(M.Content,{align:"center",side:"top",className:"bg-ui-bg-component focus-visible:outline-none p-2",children:e.jsxs("div",{className:"",children:[e.jsxs(K,{size:"2xsmall",className:"mb-2",rounded:"full",children:[r,": #",o.slice(-7)]}),e.jsxs(d,{size:"xsmall",children:[e.jsx("span",{className:"text-ui-fg-subtle",children:t("orders.returns.returnRequested")})," · ",be(s.requested_at)]}),e.jsxs(d,{size:"xsmall",children:[e.jsx("span",{className:"text-ui-fg-subtle",children:t("orders.returns.itemReceived")})," · ",s.received_at?be(s.received_at):"-"]})]})})]})}var ae=Nt;function Ct({shippingMethod:s}){const{t}=y(),i=s==null?void 0:s.detail;if(!i)return;let a=t("orders.return"),n=i.return_id;if(i.claim_id&&(a=t("orders.claim"),n=i.claim_id),i.exchange_id&&(a=t("orders.exchange"),n=i.exchange_id),!!n)return e.jsx(D,{content:e.jsxs(K,{size:"2xsmall",rounded:"full",children:[a,": #",n.slice(-7)]}),children:e.jsx(ke,{className:"inline-block text-ui-fg-muted ml-1"})})}var zt=Ct,Ot=({order:s})=>{var j,_,z,k;const{t}=y(),i=$(),a=I(),{reservations:n}=vs({line_item_id:(j=s==null?void 0:s.items)==null?void 0:j.map(l=>l.id)},{enabled:Array.isArray(s==null?void 0:s.items)}),{order:c}=le(s.id),{returns:r=[]}=ne({status:"requested",order_id:s.id,fields:"+received_at"}),o=v.useMemo(()=>r.filter(l=>!l.canceled_at),[r]),u=!!o.length,x=v.useMemo(()=>{var h;if(!n)return!1;const l=new Map(n.map(C=>[C.line_item_id,C.id]));for(const C of s.items)if((h=C.variant)!=null&&h.manage_inventory&&C.quantity-C.detail.fulfilled_quantity>0&&!l.has(C.id))return!0;return!1},[n]),p=s.payment_collections.find(l=>l.status==="not_paid"),{mutateAsync:g}=bs(s.id,p==null?void 0:p.id),f=p&&(((_=s==null?void 0:s.summary)==null?void 0:_.pending_difference)||0)>0,m=(((z=s==null?void 0:s.summary)==null?void 0:z.pending_difference)||0)<0,b=async l=>{await a({title:t("orders.payment.markAsPaid"),description:t("orders.payment.markAsPaidPayment",{amount:ue(l.amount,s.currency_code)}),confirmText:t("actions.confirm"),cancelText:t("actions.cancel"),variant:"confirmation"})&&await g({order_id:s.id},{onSuccess:()=>{O.success(t("orders.payment.markAsPaidPaymentSuccess",{amount:ue(l.amount,s.currency_code)}))},onError:C=>{O.error(C.message)}})};return e.jsxs(E,{className:"divide-y divide-dashed p-0",children:[e.jsx(kt,{order:s,orderPreview:c}),e.jsx(qt,{order:s,reservations:n}),e.jsx(wt,{order:s}),e.jsx(Lt,{order:s}),(x||u||f||m)&&e.jsxs("div",{className:"bg-ui-bg-subtle flex items-center justify-end gap-x-2 rounded-b-xl px-4 py-4",children:[u&&(o.length===1?e.jsx(N,{onClick:()=>i(`/orders/${s.id}/returns/${o[0].id}/receive`),variant:"secondary",size:"small",children:t("orders.returns.receive.action")}):e.jsx(vt,{groups:[{actions:o.map(l=>{let h=l.id,C="Return";return l.exchange_id&&(h=l.exchange_id,C="Exchange"),l.claim_id&&(h=l.claim_id,C="Claim"),{label:t("orders.returns.receive.receiveItems",{id:`#${h.slice(-7)}`,returnType:C}),icon:e.jsx(Me,{}),to:`/orders/${s.id}/returns/${l.id}/receive`}})}],children:e.jsx(N,{variant:"secondary",size:"small",children:t("orders.returns.receive.action")})})),x&&e.jsx(N,{onClick:()=>i("./allocate-items"),variant:"secondary",children:t("orders.allocateItems.action")}),f&&e.jsx(Be,{paymentCollection:p,order:s}),f&&e.jsx(N,{size:"small",variant:"secondary",onClick:()=>b(p),children:t("orders.payment.markAsPaid")}),m&&e.jsx(N,{size:"small",variant:"secondary",onClick:()=>i(`/orders/${s.id}/refund`),children:t("orders.payment.refundAmount",{amount:q((((k=s==null?void 0:s.summary)==null?void 0:k.pending_difference)||0)*-1,s==null?void 0:s.currency_code)})})]})]})},kt=({order:s,orderPreview:t})=>{var r,o,u,x,p,g,f,m,b,j,_,z,k,l,h,C,oe,me;const{t:i}=y(),a=s.items.every(Fe=>!(Qe(Fe)>0)),n=((r=t==null?void 0:t.order_change)==null?void 0:r.change_type)==="edit",c=((o=t==null?void 0:t.order_change)==null?void 0:o.change_type)==="edit"&&((u=t==null?void 0:t.order_change)==null?void 0:u.status)==="pending";return e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(w,{level:"h2",children:i("fields.summary")}),e.jsx(R,{groups:[{actions:[{label:i(c?"orders.summary.editOrderContinue":"orders.summary.editOrder"),to:`/orders/${s.id}/edits`,icon:e.jsx(Es,{}),disabled:(t==null?void 0:t.order_change)&&((x=t==null?void 0:t.order_change)==null?void 0:x.change_type)!=="edit"||((p=t==null?void 0:t.order_change)==null?void 0:p.change_type)==="edit"&&((g=t==null?void 0:t.order_change)==null?void 0:g.status)==="requested"}]},{actions:[{label:i("orders.returns.create"),to:`/orders/${s.id}/returns`,icon:e.jsx(Oe,{}),disabled:a||n||!!((f=t==null?void 0:t.order_change)!=null&&f.exchange_id)||!!((m=t==null?void 0:t.order_change)!=null&&m.claim_id)},{label:(b=t==null?void 0:t.order_change)!=null&&b.id&&((j=t==null?void 0:t.order_change)!=null&&j.exchange_id)?i("orders.exchanges.manage"):i("orders.exchanges.create"),to:`/orders/${s.id}/exchanges`,icon:e.jsx(de,{}),disabled:a||n||!!((_=t==null?void 0:t.order_change)!=null&&_.return_id)&&!((z=t==null?void 0:t.order_change)!=null&&z.exchange_id)||!!((k=t==null?void 0:t.order_change)!=null&&k.claim_id)},{label:(l=t==null?void 0:t.order_change)!=null&&l.id&&((h=t==null?void 0:t.order_change)!=null&&h.claim_id)?i("orders.claims.manage"):i("orders.claims.create"),to:`/orders/${s.id}/claims`,icon:e.jsx(ze,{}),disabled:a||n||!!((C=t==null?void 0:t.order_change)!=null&&C.return_id)&&!((oe=t==null?void 0:t.order_change)!=null&&oe.claim_id)||!!((me=t==null?void 0:t.order_change)!=null&&me.exchange_id)}]}]})]})},St=({item:s,currencyCode:t,reservation:i,returns:a,claims:n,exchanges:c})=>{var p,g,f,m,b;const{t:r}=y(),o=(p=s.variant)==null?void 0:p.manage_inventory,u=o&&(((f=(g=s.variant)==null?void 0:g.inventory_items)==null?void 0:f.length)||0)>1,x=s.quantity-s.detail.fulfilled_quantity>0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center gap-x-4 px-6 py-4",children:[e.jsxs("div",{className:"flex items-start gap-x-4",children:[e.jsx(B,{src:s.thumbnail}),e.jsxs("div",{children:[e.jsx(d,{size:"small",leading:"compact",weight:"plus",className:"text-ui-fg-base",children:s.title}),s.variant_sku&&e.jsxs("div",{className:"flex items-center gap-x-1",children:[e.jsx(d,{size:"small",children:s.variant_sku}),e.jsx(T,{content:s.variant_sku,className:"text-ui-fg-muted"})]}),e.jsx(d,{size:"small",children:(b=(m=s.variant)==null?void 0:m.options)==null?void 0:b.map(j=>j.value).join(" · ")})]})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-x-4",children:[e.jsx("div",{className:"flex items-center justify-end gap-x-4",children:e.jsx(d,{size:"small",children:S(s.unit_price,t)})}),e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx("div",{className:"w-fit min-w-[27px]",children:e.jsxs(d,{size:"small",children:[e.jsx("span",{className:"tabular-nums",children:s.quantity}),"x"]})}),e.jsx("div",{className:"overflow-visible",children:o&&x&&e.jsx(F,{color:i?"green":"orange",className:"text-nowrap",children:r(i?"orders.reservations.allocatedLabel":"orders.reservations.notAllocatedLabel")})})]}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(d,{size:"small",className:"pt-[1px]",children:S(s.subtotal||0,t)})})]})]},s.id),u&&e.jsx(Et,{item:s}),a.map(j=>e.jsx(At,{orderReturn:j,itemId:s.id},j.id)),n.map(j=>e.jsx(Tt,{claim:j,itemId:s.id},j.id)),c.map(j=>e.jsx(It,{exchange:j,itemId:s.id},j.id))]})},qt=({order:s,reservations:t})=>{var r;const{claims:i=[]}=_e({order_id:s.id,fields:"*additional_items"}),{exchanges:a=[]}=Ne({order_id:s.id,fields:"*additional_items"}),{returns:n=[]}=ne({order_id:s.id,fields:"*items,*items.reason"}),c=v.useMemo(()=>new Map((t||[]).map(o=>[o.line_item_id,o])),[t]);return e.jsx("div",{children:(r=s.items)==null?void 0:r.map(o=>{const u=c.get(o.id);return e.jsx(St,{item:o,currencyCode:s.currency_code,reservation:u,returns:n,exchanges:a,claims:i},o.id)})})},se=({label:s,value:t,secondaryValue:i,tooltip:a})=>e.jsxs("div",{className:"grid grid-cols-3 items-center",children:[e.jsxs(d,{size:"small",leading:"compact",children:[s," ",a]}),e.jsx("div",{className:"text-right",children:e.jsx(d,{size:"small",leading:"compact",children:i})}),e.jsx("div",{className:"text-right",children:e.jsx(d,{size:"small",leading:"compact",children:t})})]}),wt=({order:s})=>{var g;const{t}=y(),[i,a]=v.useState(!1),[n,c]=v.useState(!1),r=v.useMemo(()=>{const f=new Set;return s.items.forEach(m=>{var b;return(b=m.adjustments)==null?void 0:b.forEach(j=>{f.add(j.code)})}),Array.from(f).sort()},[s]),o=v.useMemo(()=>{const f={};return s.items.forEach(m=>{var b;(b=m.tax_lines)==null||b.forEach(j=>{f[j.code]=(f[j.code]||0)+j.total})}),s.shipping_methods.forEach(m=>{var b;(b=m.tax_lines)==null||b.forEach(j=>{f[j.code]=(f[j.code]||0)+j.total})}),f},[s]),u=!!((g=s.region)!=null&&g.automatic_taxes),x=!!Object.keys(o).length,p=u?s.discount_total:s.discount_subtotal;return e.jsxs("div",{className:"text-ui-fg-subtle flex flex-col gap-y-2 px-6 py-4",children:[e.jsx(se,{label:t(u?"orders.summary.itemTotal":"orders.summary.itemSubtotal"),value:S(s.item_total,s.currency_code)}),e.jsx(se,{label:e.jsxs("div",{onClick:()=>c(f=>!f),className:"flex cursor-pointer items-center gap-1",children:[e.jsx("span",{children:t(u?"orders.summary.shippingTotal":"orders.summary.shippingSubtotal")}),e.jsx(te,{style:{transform:`rotate(${n?0:-90}deg)`}})]}),value:S(u?s.shipping_total:s.shipping_subtotal,s.currency_code)}),n&&e.jsx("div",{className:"flex flex-col gap-1 pl-5",children:(s.shipping_methods||[]).sort((f,m)=>f.created_at.localeCompare(m.created_at)).map((f,m)=>e.jsxs("div",{className:"flex items-center justify-between gap-x-2",children:[e.jsx("div",{children:e.jsxs("span",{className:"txt-small text-ui-fg-subtle font-medium",children:[f.name,f.detail.return_id&&` (${t("fields.returnShipping")})`," ",e.jsx(zt,{shippingMethod:f},m)]})}),e.jsx("div",{className:"relative flex-1",children:e.jsx("div",{className:"bottom-[calc(50% - 2px)] absolute h-[1px] w-full border-b border-dashed"})}),e.jsx("span",{className:"txt-small text-ui-fg-muted",children:S(u?f.total:f.subtotal,s.currency_code)})]},f.id))}),e.jsx(se,{label:t(u?"orders.summary.discountTotal":"orders.summary.discountSubtotal"),secondaryValue:r.join(", "),value:p>0?`- ${S(p,s.currency_code)}`:"-"}),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{onClick:()=>x&&a(f=>!f),className:W("flex items-center gap-1",{"cursor-pointer":x}),children:[e.jsx("span",{className:"txt-small select-none",children:t(u?"orders.summary.taxTotalIncl":"orders.summary.taxTotal")}),x&&e.jsx(te,{style:{transform:`rotate(${i?0:-90}deg)`}})]}),e.jsx("div",{className:"text-right",children:e.jsx(d,{size:"small",leading:"compact",children:S(s.tax_total,s.currency_code)})})]}),i&&e.jsx("div",{className:"flex flex-col gap-1 pl-5",children:Object.entries(o).map(([f,m])=>e.jsxs("div",{className:"flex items-center justify-between gap-x-2",children:[e.jsx("div",{children:e.jsx("span",{className:"txt-small text-ui-fg-subtle font-medium",children:f})}),e.jsx("div",{className:"relative flex-1",children:e.jsx("div",{className:"bottom-[calc(50% - 2px)] absolute h-[1px] w-full border-b border-dashed"})}),e.jsx("span",{className:"txt-small text-ui-fg-muted",children:S(m,s.currency_code)})]},f))})]})]})},Et=({item:s})=>{var c;const{t}=y(),[i,a]=v.useState(!1),n=((c=s.variant)==null?void 0:c.inventory_items)||[];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{onClick:()=>a(r=>!r),className:"flex cursor-pointer items-center gap-2 border-t border-dashed px-6 py-4",children:[e.jsx(te,{style:{transform:`rotate(${i?0:-90}deg)`}}),e.jsx("span",{className:"text-ui-fg-muted txt-small select-none",children:t("orders.summary.inventoryKit",{count:n.length})})]}),i&&e.jsx("div",{className:"flex flex-col gap-1 px-6 pb-4",children:n.map(r=>e.jsxs("div",{className:"flex items-center justify-between gap-x-2",children:[e.jsx("div",{children:e.jsxs("span",{className:"txt-small text-ui-fg-subtle font-medium",children:[r.inventory.title,r.inventory.sku&&e.jsxs("span",{className:"text-ui-fg-subtle font-normal",children:[" ","⋅ ",r.inventory.sku]})]})}),e.jsx("div",{className:"relative flex-1",children:e.jsx("div",{className:"bottom-[calc(50% - 2px)] absolute h-[1px] w-full border-b border-dashed"})}),e.jsxs("span",{className:"txt-small text-ui-fg-muted",children:[r.required_quantity,"x"]})]},r.inventory.id))})]})},Mt=({orderReturn:s,itemId:t})=>{var c,r;const{t:i}=y(),a=(c=s==null?void 0:s.items)==null?void 0:c.find(o=>o.item_id===t),n=(a==null?void 0:a.damaged_quantity)||0;return a&&e.jsxs("div",{className:"txt-compact-small-plus text-ui-fg-subtle bg-ui-bg-subtle flex flex-row justify-between gap-y-2 border-t-2 border-dotted px-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"text-ui-fg-muted"}),e.jsx(d,{size:"small",children:i("orders.returns.damagedItemsReturned",{quantity:n})}),(a==null?void 0:a.note)&&e.jsx(D,{content:a.note,children:e.jsx(qe,{className:"text-ui-tag-neutral-icon ml-1 inline"})}),(a==null?void 0:a.reason)&&e.jsx(K,{size:"2xsmall",className:"cursor-default select-none capitalize",rounded:"full",children:(r=a==null?void 0:a.reason)==null?void 0:r.label})]}),e.jsxs(d,{size:"small",leading:"compact",className:"text-ui-fg-muted",children:[i("orders.returns.damagedItemReceived"),e.jsx("span",{className:"ml-2",children:e.jsx(ae,{orderReturn:s})})]})]},s.id)},At=({orderReturn:s,itemId:t})=>{var o,u;const{t:i}=y(),{getRelativeDate:a}=G();if(!["requested","received","partially_received"].includes(s.status||""))return null;const n=s.status==="requested",c=(o=s==null?void 0:s.items)==null?void 0:o.find(x=>x.item_id===t),r=(c==null?void 0:c.damaged_quantity)||0;return c&&e.jsxs(e.Fragment,{children:[r>0&&e.jsx(Mt,{orderReturn:s,itemId:t}),e.jsxs("div",{className:"txt-compact-small-plus text-ui-fg-subtle bg-ui-bg-subtle flex flex-row justify-between gap-y-2 border-t-2 border-dotted px-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"text-ui-fg-muted"}),e.jsx(d,{size:"small",children:i(`orders.returns.${n?"returnRequestedInfo":"returnReceivedInfo"}`,{requestedItemsCount:c==null?void 0:c[n?"quantity":"received_quantity"]})}),(c==null?void 0:c.note)&&e.jsx(D,{content:c.note,children:e.jsx(qe,{className:"text-ui-tag-neutral-icon ml-1 inline"})}),(c==null?void 0:c.reason)&&e.jsx(K,{size:"2xsmall",className:"cursor-default select-none capitalize",rounded:"full",children:(u=c==null?void 0:c.reason)==null?void 0:u.label})]}),s&&n&&e.jsxs(d,{size:"small",leading:"compact",className:"text-ui-fg-muted",children:[a(s.created_at),e.jsx("span",{className:"ml-2",children:e.jsx(ae,{orderReturn:s})})]}),s&&!n&&e.jsxs(d,{size:"small",leading:"compact",className:"text-ui-fg-muted",children:[i("orders.returns.itemReceived"),e.jsx("span",{className:"ml-2",children:e.jsx(ae,{orderReturn:s})})]})]},c.id)]})},Tt=({claim:s,itemId:t})=>{const{t:i}=y(),{getRelativeDate:a}=G(),n=s.additional_items.filter(c=>{var r;return((r=c.item)==null?void 0:r.id)===t});return!!n.length&&e.jsxs("div",{className:"txt-compact-small-plus text-ui-fg-subtle bg-ui-bg-subtle flex flex-row justify-between gap-y-2 border-b-2 border-t-2 border-dotted px-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"text-ui-fg-muted"}),e.jsx(d,{size:"small",children:i("orders.claims.outboundItemAdded",{itemsCount:n.reduce((c,r)=>c=c+r.quantity,0)})})]}),e.jsx(d,{size:"small",leading:"compact",className:"text-ui-fg-muted",children:a(s.created_at)})]},s.id)},It=({exchange:s,itemId:t})=>{const{t:i}=y(),{getRelativeDate:a}=G(),n=s.additional_items.filter(c=>{var r;return((r=c==null?void 0:c.item)==null?void 0:r.id)===t});return!!n.length&&e.jsxs("div",{className:"txt-compact-small-plus text-ui-fg-subtle bg-ui-bg-subtle flex flex-row justify-between gap-y-2 border-b-2 border-t-2 border-dotted px-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"text-ui-fg-muted"}),e.jsx(d,{size:"small",children:i("orders.exchanges.outboundItemAdded",{itemsCount:n.reduce((c,r)=>c=c+r.quantity,0)})})]}),e.jsx(d,{size:"small",leading:"compact",className:"text-ui-fg-muted",children:a(s.created_at)})]},s.id)},Lt=({order:s})=>{const{t}=y();return e.jsxs("div",{className:" flex flex-col gap-y-2 px-6 py-4",children:[e.jsxs("div",{className:"text-ui-fg-base flex items-center justify-between",children:[e.jsx(d,{weight:"plus",className:"text-ui-fg-subtle",size:"small",leading:"compact",children:t("fields.total")}),e.jsx(d,{weight:"plus",className:"text-ui-fg-subtle",size:"small",leading:"compact",children:q(s.total,s.currency_code)})]}),e.jsxs("div",{className:"text-ui-fg-base flex items-center justify-between",children:[e.jsx(d,{weight:"plus",className:"text-ui-fg-subtle",size:"small",leading:"compact",children:t("fields.paidTotal")}),e.jsx(d,{weight:"plus",className:"text-ui-fg-subtle",size:"small",leading:"compact",children:q(Xe(s.payment_collections||[]),s.currency_code)})]}),e.jsxs("div",{className:"text-ui-fg-base flex items-center justify-between",children:[e.jsx(d,{className:"text-ui-fg-subtle text-semibold",size:"small",leading:"compact",weight:"plus",children:t("orders.returns.outstandingAmount")}),e.jsx(d,{className:"text-ui-fg-subtle text-bold",size:"small",leading:"compact",weight:"plus",children:q(s.summary.pending_difference||0,s.currency_code)})]})]})},ya=()=>{const s=ns(),{id:t}=ls(),{getWidgets:i}=cs(),{order:a,isLoading:n,isError:c,error:r}=Ce(t,{fields:ie},{initialData:s});a&&(a.items=a.items.sort((x,p)=>x.created_at>p.created_at?1:x.created_at<p.created_at?-1:0));const{order:o,isLoading:u}=le(t);if(n||!a||u)return e.jsx(rs,{mainSections:4,sidebarSections:2,showJSON:!0});if(c)throw r;return e.jsxs(Z,{widgets:{after:i("order.details.after"),before:i("order.details.before"),sideAfter:i("order.details.side.after"),sideBefore:i("order.details.side.before")},data:a,showJSON:!0,hasOutlet:!0,children:[e.jsxs(Z.Main,{children:[e.jsx(Vs,{order:a}),e.jsx(Hs,{orderPreview:o}),e.jsx(Us,{orderPreview:o}),e.jsx(Ws,{orderPreview:o}),e.jsx(gt,{order:a}),e.jsx(Ot,{order:a}),e.jsx(Ge,{order:a}),e.jsx(xt,{order:a})]}),e.jsxs(Z.Sidebar,{children:[e.jsx(mt,{order:a}),e.jsx(nt,{order:a})]})]})};export{ga as Breadcrumb,ya as Component,ja as loader};
