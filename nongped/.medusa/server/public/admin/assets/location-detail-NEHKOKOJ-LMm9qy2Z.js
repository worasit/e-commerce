import{i as y,a as se}from"./chunk-R2O6QX4D-CX21ziz_.js";import{I as D}from"./chunk-EQTBJSBZ-D1bdh4mc.js";import{L as q}from"./chunk-I3VB6NM2-fc999K3u.js";import{f as V}from"./chunk-IR5DHEKS-aVJcUHa1.js";import{L as A}from"./chunk-6WKBBTKM-CAZ7K6vx.js";import{r,aS as W,j as s,q as te,d as ne,R as ie,a as ae,S as oe,df as re,s as le,H as N,T as h,b as x,eJ as ce,W as z,A as g,u as de,eB as pe,d2 as me,I as fe,aY as ue,t as m,J as xe,eK as he,D as F,Y as ge,av as ve}from"./index-CJZ0utKv.js";import{a as je}from"./chunk-OIAPXGI2-D0wb1bhE.js";import{T as E}from"./chunk-2RQLKDBF-DdHfvUFV.js";import{N as M}from"./chunk-WX2SMNCD-gsBa7lx4.js";import{u as _e,a as ye}from"./chunk-RVOQ4QHC-CNrryUdx.js";import{a as be}from"./chunk-STLKFKTM-Psl18YG9.js";import{T as O}from"./trash-Dbmfz9SX.js";import{P as _}from"./pencil-square-CANgz5Uf.js";import{C as we}from"./channels-9NXhnbKC.js";import{u as S}from"./use-prompt-Bi7FceQH.js";import{C as $}from"./container-CvrRqui1.js";import{S as ke}from"./status-badge-K2cHY97K.js";import"./Trans-CyKh6hGN.js";import"./x-mark-mini-ysYOSGAt.js";import"./plus-mini-BdX2C9J6.js";import"./prompt-Di3JszOJ.js";var Le=Object.defineProperty,b=Object.getOwnPropertySymbols,Y=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,Z=(e,n,t)=>n in e?Le(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Ne=(e,n)=>{for(var t in n||(n={}))Y.call(n,t)&&Z(e,t,n[t]);if(b)for(var t of b(n))J.call(n,t)&&Z(e,t,n[t]);return e},Oe=(e,n)=>{var t={};for(var i in e)Y.call(e,i)&&n.indexOf(i)<0&&(t[i]=e[i]);if(e!=null&&b)for(var i of b(e))n.indexOf(i)<0&&J.call(e,i)&&(t[i]=e[i]);return t};const K=r.forwardRef((e,n)=>{var t=e,{color:i="currentColor"}=t,a=Oe(t,["color"]);return r.createElement("svg",Ne({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:n},a),r.createElement("g",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},r.createElement("path",{d:"M12.611 5.056v6.222c0 .982-.795 1.778-1.778 1.778H4.167a1.777 1.777 0 0 1-1.778-1.778V5.056M13.056 1.944H1.944a.89.89 0 0 0-.888.89v1.333c0 .49.398.888.888.888h11.112a.89.89 0 0 0 .888-.888V2.833a.89.89 0 0 0-.889-.889M5.722 7.722h3.556"})),r.createElement("defs",null,r.createElement("clipPath",{id:"a"},r.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});K.displayName="ArchiveBox";var Se=Object.defineProperty,w=Object.getOwnPropertySymbols,Q=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable,B=(e,n,t)=>n in e?Se(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,$e=(e,n)=>{for(var t in n||(n={}))Q.call(n,t)&&B(e,t,n[t]);if(w)for(var t of w(n))G.call(n,t)&&B(e,t,n[t]);return e},Pe=(e,n)=>{var t={};for(var i in e)Q.call(e,i)&&n.indexOf(i)<0&&(t[i]=e[i]);if(e!=null&&w)for(var i of w(e))n.indexOf(i)<0&&G.call(e,i)&&(t[i]=e[i]);return t};const U=r.forwardRef((e,n)=>{var t=e,{color:i="currentColor"}=t,a=Pe(t,["color"]);return r.createElement("svg",$e({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:n},a),r.createElement("path",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M10.192 2.927 6.465 3.99a.86.86 0 0 0-.591 1.064l.944 3.312a.86.86 0 0 0 1.065.592l3.726-1.063a.86.86 0 0 0 .592-1.064l-.945-3.312a.86.86 0 0 0-1.064-.592M8.328 3.459l.473 1.656M6.876 11.708l7.298-2.081M4.933 10.357 2.77 2.744a.86.86 0 0 0-.828-.626h-.9"}),r.createElement("path",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5.347 13.313a1.507 1.507 0 1 0 0-3.014 1.507 1.507 0 0 0 0 3.014"}))});U.displayName="HandTruck";var Ce=Object.defineProperty,k=Object.getOwnPropertySymbols,X=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable,R=(e,n,t)=>n in e?Ce(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Ee=(e,n)=>{for(var t in n||(n={}))X.call(n,t)&&R(e,t,n[t]);if(k)for(var t of k(n))ee.call(n,t)&&R(e,t,n[t]);return e},Te=(e,n)=>{var t={};for(var i in e)X.call(e,i)&&n.indexOf(i)<0&&(t[i]=e[i]);if(e!=null&&k)for(var i of k(e))n.indexOf(i)<0&&ee.call(e,i)&&(t[i]=e[i]);return t};const T=r.forwardRef((e,n)=>{var t=e,{color:i="currentColor"}=t,a=Te(t,["color"]);return r.createElement("svg",Ee({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:n},a),r.createElement("g",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},r.createElement("path",{d:"M5.056 1.982v9.333M9.944 3.685v9.333M1.752 2.679 4.802 2a.9.9 0 0 1 .497.032l4.402 1.601c.159.058.331.07.497.032l2.665-.592a.888.888 0 0 1 1.081.868v7.513c0 .417-.29.778-.696.867l-3.05.679a.9.9 0 0 1-.497-.032l-4.402-1.601a.9.9 0 0 0-.497-.032l-2.665.592a.89.89 0 0 1-1.081-.868V3.546c0-.417.29-.778.696-.867"})),r.createElement("defs",null,r.createElement("clipPath",{id:"a"},r.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});T.displayName="Map";var L="name,*sales_channels,*address,fulfillment_sets.type,fulfillment_sets.name,*fulfillment_sets.service_zones.geo_zones,*fulfillment_sets.service_zones,*fulfillment_sets.service_zones.shipping_options,*fulfillment_sets.service_zones.shipping_options.rules,*fulfillment_sets.service_zones.shipping_options.shipping_profile,*fulfillment_providers",ds=e=>{const{location_id:n}=e.params||{},{stock_location:t}=W(n,{fields:L},{initialData:e.data,enabled:!!n});return t?s.jsx("span",{children:t.name}):null},De=e=>({queryKey:re.detail(e,{fields:L}),queryFn:async()=>le.admin.stockLocation.retrieve(e,{fields:L})}),ps=async({params:e})=>{const n=e.location_id,t=De(n);return te.ensureQueryData(t)},Me=({location:e})=>{var n,t;return s.jsxs(s.Fragment,{children:[s.jsx($,{className:"p-0",children:s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsxs("div",{children:[s.jsx(N,{children:e.name}),s.jsx(h,{className:"text-ui-fg-subtle txt-small",children:je({address:e.address}).join(", ")})]}),s.jsx(Fe,{location:e})]})}),s.jsx(I,{locationId:e.id,locationName:e.name,type:"pickup",fulfillmentSet:(n=e.fulfillment_sets)==null?void 0:n.find(i=>i.type==="pickup")}),s.jsx(I,{locationId:e.id,locationName:e.name,type:"shipping",fulfillmentSet:(t=e.fulfillment_sets)==null?void 0:t.find(i=>i.type==="shipping")})]})};function H({option:e,fulfillmentSetId:n,locationId:t}){const i=S(),{t:a}=x(),l=se(e),{mutateAsync:o}=be(e.id),p=async()=>{await i({title:a("general.areYouSure"),description:a("stockLocations.shippingOptions.delete.confirmation",{name:e.name}),verificationInstruction:a("general.typeToConfirm"),verificationText:e.name,confirmText:a("actions.delete"),cancelText:a("actions.cancel")})&&await o(void 0,{onSuccess:()=>{m.success(a("stockLocations.shippingOptions.delete.successToast",{name:e.name}))},onError:j=>{m.error(j.message)}})};return s.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[s.jsx("div",{className:"flex-1",children:s.jsxs(h,{size:"small",weight:"plus",children:[e.name," - ",e.shipping_profile.name," (",V(e.provider_id),")"]})}),s.jsx(ge,{className:"mr-4",color:l?"grey":"purple",size:"2xsmall",rounded:"full",children:a(l?"general.store":"general.admin")}),s.jsx(g,{groups:[{actions:[{icon:s.jsx(_,{}),label:a("stockLocations.shippingOptions.edit.action"),to:`/settings/locations/${t}/fulfillment-set/${n}/service-zone/${e.service_zone_id}/shipping-option/${e.id}/edit`},{label:a("stockLocations.shippingOptions.pricing.action"),icon:s.jsx(ve,{}),to:`/settings/locations/${t}/fulfillment-set/${n}/service-zone/${e.service_zone_id}/shipping-option/${e.id}/pricing`}]},{actions:[{label:a("actions.delete"),icon:s.jsx(O,{}),onClick:p}]}]})]})}function Ae({zone:e,locationId:n,fulfillmentSetId:t}){const{t:i}=x(),a=e.shipping_options.filter(o=>!y(o)),l=e.shipping_options.filter(o=>y(o));return s.jsxs("div",{children:[s.jsx(F,{variant:"dashed"}),s.jsxs("div",{className:"flex flex-col gap-y-4 px-6 py-4",children:[s.jsxs("div",{className:"item-center flex justify-between",children:[s.jsx("span",{className:"text-ui-fg-subtle txt-small self-center font-medium",children:i("stockLocations.shippingOptions.create.shipping.label")}),s.jsx(A,{to:`/settings/locations/${n}/fulfillment-set/${t}/service-zone/${e.id}/shipping-option/create`,children:i("stockLocations.shippingOptions.create.action")})]}),!!a.length&&s.jsx("div",{className:"shadow-elevation-card-rest bg-ui-bg-subtle grid divide-y rounded-md",children:a.map(o=>s.jsx(H,{option:o,locationId:n,fulfillmentSetId:t},o.id))})]}),s.jsx(F,{variant:"dashed"}),s.jsxs("div",{className:"flex flex-col gap-y-4 px-6 py-4",children:[s.jsxs("div",{className:"item-center flex justify-between",children:[s.jsx("span",{className:"text-ui-fg-subtle txt-small self-center font-medium",children:i("stockLocations.shippingOptions.create.returns.label")}),s.jsx(A,{to:`/settings/locations/${n}/fulfillment-set/${t}/service-zone/${e.id}/shipping-option/create?is_return`,children:i("stockLocations.shippingOptions.create.action")})]}),!!l.length&&s.jsx("div",{className:"shadow-elevation-card-rest bg-ui-bg-subtle grid divide-y rounded-md",children:l.map(o=>s.jsx(H,{option:o,locationId:n,fulfillmentSetId:t},o.id))})]})]})}function ze({zone:e,locationId:n,fulfillmentSetId:t}){const{t:i}=x(),a=S(),[l,o]=r.useState(!0),{mutateAsync:p}=ye(t,e.id),v=async()=>{await a({title:i("general.areYouSure"),description:i("stockLocations.serviceZones.delete.confirmation",{name:e.name}),confirmText:i("actions.delete"),cancelText:i("actions.cancel")})&&await p(void 0,{onError:f=>{m.error(f.message)},onSuccess:()=>{m.success(i("stockLocations.serviceZones.delete.successToast",{name:e.name}))}})},j=r.useMemo(()=>{const d=e.geo_zones.filter(c=>c.type==="country"),f=d.map(({country_code:c})=>me.find(u=>u.iso_2===c)).filter(c=>!!c);return d.length!==f.length&&console.warn("Some countries are missing in the static countries list",d.filter(c=>!f.find(u=>u.iso_2===c.country_code)).map(c=>c.country_code)),f.sort((c,u)=>c.name.localeCompare(u.name))},[e.geo_zones]),[P,C]=r.useMemo(()=>{const d=e.shipping_options,f=d.filter(u=>!y(u)).length,c=d.filter(y).length;return[f,c]},[e.shipping_options]);return s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("div",{className:"flex flex-row items-center justify-between gap-x-4 px-6 py-4",children:[s.jsx(D,{children:s.jsx(T,{})}),s.jsxs("div",{className:"grow-1 flex flex-1 flex-col",children:[s.jsx(h,{size:"small",leading:"compact",weight:"plus",children:e.name}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(q,{variant:"base",list:j.map(d=>d.display_name),inline:!0,n:1}),s.jsx("span",{children:"·"}),s.jsx(h,{className:"text-ui-fg-subtle txt-small",children:i("stockLocations.shippingOptions.fields.count.shipping",{count:P})}),s.jsx("span",{children:"·"}),s.jsx(h,{className:"text-ui-fg-subtle txt-small",children:i("stockLocations.shippingOptions.fields.count.returns",{count:C})})]})]}),s.jsxs("div",{className:"flex grow-0 items-center gap-4",children:[s.jsx(fe,{size:"small",onClick:()=>o(d=>!d),variant:"transparent",children:s.jsx(ue,{style:{transform:`rotate(${l?180:0}deg)`,transition:".2s transform ease-in-out"}})}),s.jsx(g,{groups:[{actions:[{label:i("actions.edit"),icon:s.jsx(_,{}),to:`/settings/locations/${n}/fulfillment-set/${t}/service-zone/${e.id}/edit`},{label:i("stockLocations.serviceZones.manageAreas.action"),icon:s.jsx(T,{}),to:`/settings/locations/${n}/fulfillment-set/${t}/service-zone/${e.id}/areas`}]},{actions:[{label:i("actions.delete"),icon:s.jsx(O,{}),onClick:v}]}]})]})]}),l&&s.jsx(Ae,{fulfillmentSetId:t,locationId:n,zone:e})]})}function I(e){const{t:n}=x(),t=S(),{fulfillmentSet:i,locationName:a,locationId:l,type:o}=e,p=!!i,v=!!(i!=null&&i.service_zones.length),{mutateAsync:j}=ce(l),{mutateAsync:P}=_e(i==null?void 0:i.id),C=async()=>{await j({name:`${a} ${o==="pickup"?"pick up":o}`,type:o},{onSuccess:()=>{m.success(n(`stockLocations.fulfillmentSets.enable.${o}`))},onError:c=>{m.error(c.message)}})},d=async()=>{await t({title:n("general.areYouSure"),description:n("stockLocations.fulfillmentSets.disable.confirmation",{name:i==null?void 0:i.name}),confirmText:n("actions.disable"),cancelText:n("actions.cancel")})&&await P(void 0,{onSuccess:()=>{m.success(n(`stockLocations.fulfillmentSets.disable.${o}`))},onError:u=>{m.error(u.message)}})},f=i?[{actions:[{icon:s.jsx(z,{}),label:n("stockLocations.serviceZones.create.action"),to:`/settings/locations/${l}/fulfillment-set/${i.id}/service-zones/create`}]},{actions:[{icon:s.jsx(O,{}),label:n("actions.disable"),onClick:d}]}]:[{actions:[{icon:s.jsx(z,{}),label:n("actions.enable"),onClick:C}]}];return s.jsx($,{className:"p-0",children:s.jsxs("div",{className:"flex flex-col divide-y",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsx(N,{level:"h2",children:n(`stockLocations.fulfillmentSets.${o}.header`)}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(ke,{color:p?"green":"grey",children:n(p?"statuses.enabled":"statuses.disabled")}),s.jsx(g,{groups:f})]})]}),p&&!v&&s.jsx("div",{className:"flex items-center justify-center py-8 pt-6",children:s.jsx(M,{message:n("stockLocations.serviceZones.fields.noRecords"),className:"h-fit",action:{to:`/settings/locations/${l}/fulfillment-set/${i.id}/service-zones/create`,label:n("stockLocations.serviceZones.create.action")}})}),v&&s.jsx("div",{className:"flex flex-col divide-y",children:i==null?void 0:i.service_zones.map(c=>s.jsx(ze,{zone:c,locationId:l,fulfillmentSetId:i.id},c.id))})]})})}var Fe=({location:e})=>{const n=de(),{t}=x(),{mutateAsync:i}=pe(e.id),a=S(),l=async()=>{await a({title:t("general.areYouSure"),description:t("stockLocations.delete.confirmation",{name:e.name}),verificationText:e.name,verificationInstruction:t("general.typeToConfirm"),confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&await i(void 0,{onSuccess:()=>{m.success(t("stockLocations.create.successToast",{name:e.name})),n("/settings/locations",{replace:!0})},onError:p=>{m.error(p.message)}})};return s.jsx(g,{groups:[{actions:[{icon:s.jsx(_,{}),label:t("actions.edit"),to:"edit"},{icon:s.jsx(K,{}),label:t("stockLocations.edit.viewInventory"),to:`/inventory?location_id=${e.id}`}]},{actions:[{icon:s.jsx(O,{}),label:t("actions.delete"),onClick:l}]}]})};function Ze({location:e}){var a,l,o;const{t:n}=x(),{count:t}=xe({limit:1,fields:"id"}),i=!!((a=e.sales_channels)!=null&&a.length);return s.jsxs($,{className:"flex flex-col px-6 py-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(N,{level:"h2",children:n("stockLocations.salesChannels.header")}),s.jsx(g,{groups:[{actions:[{label:n("actions.edit"),to:"sales-channels",icon:s.jsx(_,{})}]}]})]}),i?s.jsxs("div",{className:"flex flex-col gap-y-4 pt-4",children:[s.jsxs("div",{className:"grid grid-cols-[28px_1fr] items-center gap-x-3",children:[s.jsx(D,{children:s.jsx(we,{className:"text-ui-fg-subtle"})}),s.jsx(q,{n:3,className:"text-ui-fg-base",inline:!0,list:((l=e.sales_channels)==null?void 0:l.map(p=>p.name))??[]})]}),s.jsx(h,{className:"text-ui-fg-subtle",size:"small",leading:"compact",children:n("stockLocations.salesChannels.connectedTo",{count:(o=e.sales_channels)==null?void 0:o.length,total:t})})]}):s.jsx(M,{className:"h-fit pb-2 pt-6",action:{label:n("stockLocations.salesChannels.action"),to:"sales-channels"},message:n("stockLocations.salesChannels.noChannels")})]})}var Be=Ze;function Re({location:e}){const{t:n}=x(),{fulfillment_providers:t}=he({stock_location_id:e.id,fields:"id",is_enabled:!0});return s.jsxs($,{className:"flex flex-col px-6 py-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(N,{level:"h2",children:n("stockLocations.fulfillmentProviders.header")}),s.jsx(g,{groups:[{actions:[{label:n("actions.edit"),to:"fulfillment-providers",icon:s.jsx(_,{})}]}]})]}),t!=null&&t.length?s.jsx("div",{className:"flex flex-col gap-y-4 pt-4",children:s.jsx("div",{className:"grid grid-cols-[28px_1fr] items-center gap-x-3 gap-y-3",children:t==null?void 0:t.map(i=>s.jsxs(s.Fragment,{children:[s.jsx(D,{children:s.jsx(U,{className:"text-ui-fg-subtle"})}),s.jsx("div",{className:"txt-compact-small",children:V(i.id)})]}))})}):s.jsx(M,{className:"h-fit pb-2 pt-6 text-center",action:{label:n("stockLocations.fulfillmentProviders.action"),to:"fulfillment-providers"},message:n("stockLocations.fulfillmentProviders.noProviders")})]})}var He=Re,ms=()=>{const e=ne(),{location_id:n}=ie(),{stock_location:t,isPending:i,isError:a,error:l}=W(n,{fields:L},{initialData:e}),{getWidgets:o}=ae();if(i||!t)return s.jsx(oe,{mainSections:3,sidebarSections:2,showJSON:!0});if(a)throw l;return s.jsxs(E,{widgets:{after:o("location.details.after"),before:o("location.details.before"),sideAfter:o("location.details.side.after"),sideBefore:o("location.details.side.before")},data:t,showJSON:!0,hasOutlet:!0,children:[s.jsx(E.Main,{children:s.jsx(Me,{location:t})}),s.jsxs(E.Sidebar,{children:[s.jsx(Be,{location:t}),s.jsx(He,{location:t})]})]})};export{ds as Breadcrumb,ms as Component,ps as loader};
